<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function writes standardised structure factors data into an ASCII
file. The files includes cell size, space group character symbol and
Miller indices vector. It can include all of some of observed and/or
calculated structure factors amplitudes and phases, either for anomalous
or non-anomalous data."><title>Write structure factors to a reflections file — write_h • crone</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Write structure factors to a reflections file — write_h"><meta property="og:description" content="This function writes standardised structure factors data into an ASCII
file. The files includes cell size, space group character symbol and
Miller indices vector. It can include all of some of observed and/or
calculated structure factors amplitudes and phases, either for anomalous
or non-anomalous data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">crone</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Write structure factors to a reflections file</h1>
      
      <div class="d-none name"><code>write_h.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function writes standardised structure factors data into an ASCII
file. The files includes cell size, space group character symbol and
Miller indices vector. It can include all of some of observed and/or
calculated structure factors amplitudes and phases, either for anomalous
or non-anomalous data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">write_h</span><span class="op">(</span><span class="va">filename</span>, <span class="va">fdata</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>filename</dt>
<dd><p>A character string. Prefix of the structure factors
file name. The file name has the form "[prefix]_h.dat".</p></dd>


<dt>fdata</dt>
<dd><p>A names list, usually created with functions 
<code><a href="standardise_fdata.html">standardise_fdata</a></code> or <code><a href="read_h.html">read_h</a></code>, and consisting of
the following fields:</p><ul><li><p>a    Real numeric. Unit cell length in angstroms. Always 
             included.</p></li>
<li><p>SG.   Spacegroup 2-letters character string. There are only two 
              symmetries possible when working within 1D 
              crystallography, P1 (no symmetry) and P-1 (inversion 
              through the origin). SG can be either "P1" or "P-1". 
              Always included.</p></li>
<li><p>hidx. Real numeric array. 1D unique (positive in the 1D context) 
              Miller indices. Always included.</p></li>
<li><p>Fobs.      Real numeric array. Amplitudes of observed structure 
                   factors. Not always included.</p></li>
<li><p>sigFobs.   Real numeric array. Errors associated with Fobs. Not 
                   always included.</p></li>
<li><p>Fp.        Real numeric vector. Amplitudes of the positive 
                   component of Friedel (or Bijvoet) pairs (F+). Not
                   always included.</p></li>
<li><p>sigFp.     Real numeric vector. Errors associated with Fp. 
                   Not always included.</p></li>
<li><p>Fm.        Real numeric vector. Amplitudes of the negative 
                   component of Friedel (or Bijvoet) pairs (F-). Not always
                   included.</p></li>
<li><p>sigFm.     Real numeric vector. Errors associated with Fm. Not
                   always included.</p></li>
<li><p>Phiobs.    Real numeric array. Phases (in degrees) of structure 
                   factors obtained with one of the methods used for 
                   structure solution. Not always included.</p></li>
<li><p>Phicalc.   Real numeric array. Phases (in degrees) of structure 
                   factors calculated from the correct 1D structure. 
                   They are normally used to check correctness of 
                   Phiobs. Not always included.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>This function does not return anything, but will create an ASCII 
 file of name *_h.dat which contains structure factors and other type of 
 information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Data from thiocyanate structure</span></span></span>
<span class="r-in"><span><span class="va">datadir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,package<span class="op">=</span><span class="st">"crone"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">datadir</span>,<span class="st">"thiocyanate_x.dat"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_x.html">read_x</a></span><span class="op">(</span><span class="va">filename</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Miller indices</span></span></span>
<span class="r-in"><span><span class="va">hidx</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Observed structure factors with errors</span></span></span>
<span class="r-in"><span><span class="va">ltmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="SFobs.html">sfobs</a></span><span class="op">(</span><span class="va">hidx</span>,<span class="va">sdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Fobs</span> <span class="op">&lt;-</span> <span class="va">ltmp</span><span class="op">$</span><span class="cn">F</span></span></span>
<span class="r-in"><span><span class="va">sigFobs</span> <span class="op">&lt;-</span> <span class="va">ltmp</span><span class="op">$</span><span class="va">sF</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Phases from calculated structure factors</span></span></span>
<span class="r-in"><span><span class="va">ftmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="strufac.html">strufac</a></span><span class="op">(</span><span class="va">hidx</span>,<span class="va">sdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phicalc</span> <span class="op">&lt;-</span> <span class="va">ftmp</span><span class="op">$</span><span class="va">Fpha</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create standardised fdata structure</span></span></span>
<span class="r-in"><span><span class="va">fdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="standardise_fdata.html">standardise_fdata</a></span><span class="op">(</span><span class="va">sdata</span><span class="op">$</span><span class="va">a</span>,<span class="va">sdata</span><span class="op">$</span><span class="va">SG</span>,<span class="va">hidx</span>,Fobs<span class="op">=</span><span class="va">Fobs</span>,</span></span>
<span class="r-in"><span>                     sigFobs<span class="op">=</span><span class="va">sigFobs</span>,Phicalc<span class="op">=</span><span class="va">phicalc</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Name of structure factors file (in temporary directory)</span></span></span>
<span class="r-in"><span><span class="va">wd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>,<span class="st">"test"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Write data to file</span></span></span>
<span class="r-in"><span><span class="fu">write_h</span><span class="op">(</span><span class="va">fname</span>,<span class="va">fdata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James Foadi.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

