<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Analytic Fourier transform of electron density corresponding to
an array of Ncell unit cells calculated using numerical 
integration with the trapezoid rule. The diffraction peaks' height is 
proportional to the number of unit cells ( Ncell). The 
number of diffraction peaks included in the 1D diffraction pattern is 
related to the maximum resolution D provided in the input. 
The number of grid points for both the simulated electron density and
the resulting diffraction pattern can also be provided as input. A
further input parameter is the radius of the beamstop disc to stop
diffraction close to the incoming beam (as the resulting intensity far
outweigh the rest of the diffracted intensities)."><title>Simulation of 1D diffraction pattern — diffraction • crone</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation of 1D diffraction pattern — diffraction"><meta property="og:description" content="Analytic Fourier transform of electron density corresponding to
an array of Ncell unit cells calculated using numerical 
integration with the trapezoid rule. The diffraction peaks' height is 
proportional to the number of unit cells ( Ncell). The 
number of diffraction peaks included in the 1D diffraction pattern is 
related to the maximum resolution D provided in the input. 
The number of grid points for both the simulated electron density and
the resulting diffraction pattern can also be provided as input. A
further input parameter is the radius of the beamstop disc to stop
diffraction close to the incoming beam (as the resulting intensity far
outweigh the rest of the diffracted intensities)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">crone</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulation of 1D diffraction pattern</h1>
      
      <div class="d-none name"><code>diffraction.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Analytic Fourier transform of electron density corresponding to
an array of <code>Ncell</code> unit cells calculated using numerical 
integration with the trapezoid rule. The diffraction peaks' height is 
proportional to the number of unit cells ( <code>Ncell</code>). The 
number of diffraction peaks included in the 1D diffraction pattern is 
related to the maximum resolution <code>D</code> provided in the input. 
The number of grid points for both the simulated electron density and
the resulting diffraction pattern can also be provided as input. A
further input parameter is the radius of the beamstop disc to stop
diffraction close to the incoming beam (as the resulting intensity far
outweigh the rest of the diffracted intensities).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">diffraction</span><span class="op">(</span><span class="va">sdata</span>, <span class="va">D</span>, Ncell <span class="op">=</span> <span class="fl">10</span>, N <span class="op">=</span> <span class="fl">1000</span>, n <span class="op">=</span> <span class="fl">100</span>, bstop <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>sdata</dt>
<dd><p>A named list, normally obtained through the use of
functions <code><a href="read_x.html">read_x</a></code> or <code><a href="standardise_sdata.html">standardise_sdata</a></code>. 
The list names correspond to different object types:</p><ul><li><p>a.     Real numeric. The size of the unit cell.</p></li>
<li><p>SG.    Character string. Space group symbol; either "P1" 
               or "P-1"</p></li>
<li><p>x0.    Vector of real numerics indicating the expanded atomic
               positions in the unit cell.</p></li>
<li><p>Z.     Vector of integers indicating the expanded 
               atomic numbers for all atoms in the unit cell.</p></li>
<li><p>B.    Vector of real numerics indicating the expanded 
              B factors for all atoms in the unit cell.</p></li>
<li><p>occ.  Vector of real numerics indicating the expanded 
              occupancies for all atoms in the unit cell.</p></li>
</ul></dd>


<dt>D</dt>
<dd><p>Real numeric. Maximum resolution in angstroms.</p></dd>


<dt>Ncell</dt>
<dd><p>Positive integer. It is the number of unit cells in 
the 1D crystal. The default value is <code>Ncell=10</code>.</p></dd>


<dt>N</dt>
<dd><p>Positive integer indicating the number of grid points for the
electron density. The default value is <code>N=1000</code>.</p></dd>


<dt>n</dt>
<dd><p>Positive integer determining the reciprocal space grid. The
grid is made of <code>2*n+1</code> regularly-spaced points from <code>-1/D</code> 
to <code>1/D</code>. The value 0 is always at the centre of the grid. The 
default value is <code>n=100</code>.</p></dd>


<dt>bstop</dt>
<dd><p>Real numeric. Is the radius of the backstop disc. Intensities
at points closer to the origin than <code>bstop</code> are reduced to 
0. The presence of a backstop improves the contrast for all diffracted
intensities because it gets rid of the overwhelming intensity corresponding
to the origin of the reciprocal space. The default is not to include
any backstop.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A named list with two vectors of real numbers, the values of the
   reciprocal space grid points (in 1/angstrom units) <code>xstar</code></p>
 

<p>and the intensities <code>Imod</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Diffraction from just two unit cells of cyanate</span></span></span>
<span class="r-in"><span><span class="va">sdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="load_structure.html">load_structure</a></span><span class="op">(</span><span class="st">"cyanate"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Max resolution is 1 angstroms; no backstop</span></span></span>
<span class="r-in"><span><span class="va">ltmp</span> <span class="op">&lt;-</span> <span class="fu">diffraction</span><span class="op">(</span><span class="va">sdata</span>,D<span class="op">=</span><span class="fl">1</span>,Ncell<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot diffraction pattern</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ltmp</span><span class="op">$</span><span class="va">xstar</span>,<span class="va">ltmp</span><span class="op">$</span><span class="va">Imod</span>,type<span class="op">=</span><span class="st">"l"</span>,</span></span>
<span class="r-in"><span> xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">^</span><span class="st">"*"</span><span class="op">)</span><span class="op">)</span>,ylab<span class="op">=</span><span class="st">"Intensity"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="diffraction-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Diffraction from 20 unit cells with backstop of 20 angstroms diameter</span></span></span>
<span class="r-in"><span><span class="va">ltmp</span> <span class="op">&lt;-</span> <span class="fu">diffraction</span><span class="op">(</span><span class="va">sdata</span>,D<span class="op">=</span><span class="fl">1</span>,bstop<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ltmp</span><span class="op">$</span><span class="va">xstar</span>,<span class="va">ltmp</span><span class="op">$</span><span class="va">Imod</span>,type<span class="op">=</span><span class="st">"l"</span>,</span></span>
<span class="r-in"><span> xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">^</span><span class="st">"*"</span><span class="op">)</span><span class="op">)</span>,ylab<span class="op">=</span><span class="st">"Intensity"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="diffraction-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James Foadi.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

