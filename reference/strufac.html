<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Calculates structure factors corresponding to one or more 1D Miller 
indices, given the atomic content of one unit cell. Anomalous scattering 
can be included using logical flag "anoflag" (default is FALSE). Crystal 
structures are always considered with no symmetry. Thus a 1D structure 
with the P-1 symmetry will have to be expanded first with function 
"expand_to_cell".'><title>Calculation of structure factors — strufac • crone</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculation of structure factors — strufac"><meta property="og:description" content='Calculates structure factors corresponding to one or more 1D Miller 
indices, given the atomic content of one unit cell. Anomalous scattering 
can be included using logical flag "anoflag" (default is FALSE). Crystal 
structures are always considered with no symmetry. Thus a 1D structure 
with the P-1 symmetry will have to be expanded first with function 
"expand_to_cell".'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">crone</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculation of structure factors</h1>
      
      <div class="d-none name"><code>strufac.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates structure factors corresponding to one or more 1D Miller 
indices, given the atomic content of one unit cell. Anomalous scattering 
can be included using logical flag "anoflag" (default is FALSE). Crystal 
structures are always considered with no symmetry. Thus a 1D structure 
with the P-1 symmetry will have to be expanded first with function 
"expand_to_cell".</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">strufac</span><span class="op">(</span><span class="va">hidx</span>, <span class="va">sdata</span>, anoflag <span class="op">=</span> <span class="cn">FALSE</span>, aK <span class="op">=</span> <span class="va">anoK</span>, lbda <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  k <span class="op">=</span> <span class="va">ksigma</span>, f1f2out <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>hidx</dt>
<dd><p>Real numeric. One or more 1D Miller indices.</p></dd>


<dt>sdata</dt>
<dd><p>A named list, normally obtained through the use of
functions <code><a href="read_x.html">read_x</a></code> or <code><a href="standardise_sdata.html">standardise_sdata</a></code>. 
The list names correspond to different object types:</p><ul><li><p>a.     Real numeric. The size of the unit cell.</p></li>
<li><p>SG.    Character string. Space group symbol; either "P1" 
               or "P-1"</p></li>
<li><p>x0.    Vector of real numerics indicating the expanded atomic
               positions in the unit cell.</p></li>
<li><p>Z.     Vector of integers indicating the expanded 
               atomic numbers for all atoms in the unit cell.</p></li>
<li><p>B.    Vector of real numerics indicating the expanded 
              B factors for all atoms in the unit cell.</p></li>
<li><p>occ.  Vector of real numerics indicating the expanded 
              occupancies for all atoms in the unit cell.</p></li>
</ul></dd>


<dt>anoflag</dt>
<dd><p>Logical variable. If TRUE it forces scattering factors
to include anomalous contributions. As a consequence, Friedel's
pairs will not be equal.</p></dd>


<dt>aK</dt>
<dd><p>Real numeric. This is a fudge factor included to decrease the
strength of the anomalous contributions. Without aK the strength is too
high for 1D structures, compared to real 3D structures. So aK helps
bringing down the anomalous contribution within the 5<!-- %-10% normally -->
met with large-size structures. The default value is aK=0.3 (anoK is
included as internal data).</p></dd>


<dt>lbda</dt>
<dd><p>Real numeric. This is the wavelength in angstroms. Its value
is important in relation to anomalous scattering.</p></dd>


<dt>k</dt>
<dd><p>A real number. It controls the standard deviation of the 
gaussian function describing the atom and, thus, the shape of the
associated peak. The standard deviation sigma is given by:
      <code>sigma = k * sqrt(Z)</code>
The default value is k=0.05 (ksigma is included as internal data).</p></dd>


<dt>f1f2out</dt>
<dd><p>Logical variable. This variable controls output of a small
table of f' and f'' values for all chemical elements in the structure.
Default is for the table to be printed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A named list with two vectors of real numbers, the structure 
 factors amplitudes, Fmod, and phases, Fpha, corresponding to the Miller 
 indices in input.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># First create the crystal structure (P1)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">SG</span> <span class="op">&lt;-</span> <span class="st">"P1"</span></span></span>
<span class="r-in"><span><span class="va">x0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">6.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">26</span>,<span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">20</span>,<span class="fl">17</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">occ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="standardise_sdata.html">standardise_sdata</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">SG</span>,<span class="va">x0</span>,<span class="va">Z</span>,<span class="va">B</span>,<span class="va">occ</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lbda</span> <span class="op">&lt;-</span> <span class="fl">1.7</span>   <span class="co"># Close to Fe's absorption</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Miller indices (including DC (h=0) component)</span></span></span>
<span class="r-in"><span><span class="va">hidx</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now structure factors without anomalous contribution</span></span></span>
<span class="r-in"><span><span class="va">ftmp</span> <span class="op">&lt;-</span> <span class="fu">strufac</span><span class="op">(</span><span class="va">hidx</span>,<span class="va">sdata</span>,lbda<span class="op">=</span><span class="va">lbda</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ftmp</span><span class="op">$</span><span class="va">Fmod</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Includes DC component (h=0)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ftmp</span><span class="op">)</span>          <span class="co"># Amplitudes decrease with increasing</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Fmod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 40.00000000 22.11435139 10.62662935 18.96067637 13.98228591  3.60862647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  2.35915179  2.08280243  0.55065616  0.31633073  0.04479261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Fpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]    0.00000  140.08040  -50.66525   69.10247 -158.39782   32.24970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  177.61998 -103.04028   50.14049  -74.99236    0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>                     <span class="co"># resolution (Miller indices)</span></span></span>
<span class="r-in"><span>                  </span></span>
<span class="r-in"><span><span class="co"># Now try with anomalous contributions</span></span></span>
<span class="r-in"><span><span class="va">ftmp</span> <span class="op">&lt;-</span> <span class="fu">strufac</span><span class="op">(</span><span class="va">hidx</span>,<span class="va">sdata</span>,lbda<span class="op">=</span><span class="va">lbda</span>,anoflag<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Z          f1         f2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  8  0.05830568 0.03963098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 26 -2.98134400 3.75151500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  6  0.02137232 0.01120651</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ftmp</span><span class="op">)</span>  <span class="co"># DC component is not any longer real</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Fmod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 39.1461236 21.1745424 10.2696423 18.0534594 12.8899111  3.7203348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  2.6673438  0.9157309  0.9821109  1.6480042  1.4103363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Fpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]    1.669817  142.917302  -42.935720   72.572799 -154.553723   54.947857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] -149.364548  -69.220701 -174.977867  -24.913067  126.481325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James Foadi.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

